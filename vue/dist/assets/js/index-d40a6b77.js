import{p as W,q as P,r as D,s as R,t as E}from"./system-66c6ad5e.js";import{c as b}from"./select-d4c05a16.js";import{b as O,u as e}from"./index-16b2bfc2.js";import{u as y}from"./useHandleData-6ee70150.js";import{u as h,g as V}from"./serviceDict-09318a0d.js";import{o as k,C as w,q as n,t as z,M,v as l,w as s,a2 as d,L as m,K as v,x as H,au as K,aY as r}from"./vendor-7d8626b5.js";const U={class:"table-box"},Y=["onClick"],j=["onClick"],G=k({name:"system_staff"}),le=k({...G,setup(J){const{sysConfig:C}=O(),u="\u7528\u6237",p=w(),c=w(),N=[{prop:"phone",minWidth:150,label:e("login.mobile"),search:{el:"input"}},{prop:"realName",minWidth:120,label:e("system.realName")},{prop:"roleId",minWidth:120,enum:b,search:{el:"select",props:{filterable:!0}},label:e("system.role")},{prop:"shopName",minWidth:120,label:e("base.shopName")},{prop:"status",minWidth:120,label:e("common.status"),enum:h,search:{el:"select",props:{filterable:!0}},tag:!0},{prop:"sex",minWidth:120,label:e("system.gender")},{prop:"priority",minWidth:90,label:e("common.priority")},{prop:"createdAt",minWidth:170,label:e("common.createdAt")},{prop:"remark",minWidth:120,label:e("common.remark")},{prop:"operation",label:e("common.operate"),fixed:"right",width:160}],$=(o,t,a)=>{new RegExp(C.system_regex_password).test(t)?a():a(new Error)},x=[{field:"phone",type:"text",label:e("login.mobile"),placeholder:e(["common.pleaseInput","login.mobile"]),rules:[{required:!0,message:e(["common.pleaseInput","login.mobile"])}]},{field:"roleId",type:"select",label:e("system.role"),action:b,placeholder:e(["common.pleaseSelect","system.role"]),rules:[{required:!0,message:e(["common.pleaseSelect","system.role"])}]},{field:"pwd",type:"password",unmount:["update"],label:e("login.password"),placeholder:e(["common.pleaseInput","login.password"]),rules:[{required:!0,message:e(["common.pleaseInput","login.password"])},{validator:$,message:e("error.PasswordFormatError"),trigger:"blur"}]},{field:"realName",type:"text",label:e("system.realName"),placeholder:e(["common.pleaseInput","system.realName"]),rules:[{required:!0,message:e(["common.pleaseInput","system.realName"])}]},{field:"status",type:"radioButton",label:e("common.status"),optionsData:h},{field:"sex",type:"radioButton",label:e("system.gender"),optionsData:V},{field:"shopName",type:"text",label:e("base.shopName"),placeholder:e(["common.pleaseInput","base.shopName"])},{field:"priority",type:"number",label:e("common.priority"),extraProps:{precision:0}},{field:"remark",type:"text",label:e("common.remark"),placeholder:e(["common.pleaseInput","common.remark"])}],f=(o,t)=>{o==="update"&&t&&(delete t.createdAt,delete t.updatedAt,delete t.loginDate,delete t.pwdUpdateDate);let a={title:e(`common.${o}`)+u,rowData:{...t||{sex:"\u7537",status:"NORMAL"}},formType:o,api:o==="add"?P:D,getTableList:p.value.getTableList};c.value.acceptParams(a)},F=async o=>{await y(R,{id:o.id||0},e(["common.delete","system.staff"])),p.value.getTableList()},A=async o=>{const t=await y(E,{id:o.id||0},e(["common.reset","login.password"]));p.value.getTableList(),K({title:e("common.tips"),message:r("div",null,[r("p",null,[r("span",null,`\u767B\u5F55\u5730\u5740\uFF1A${window.location.host}`)]),r("p",null,[r("span",null,`\u767B\u5F55\u8D26\u53F7\uFF1A${o.phone}`)]),r("p",null,[r("span",null,`\u767B\u5F55\u5BC6\u7801\uFF1A${t.data}`)])])})};return(o,t)=>{const a=n("el-button"),g=n("arrow-down"),T=n("el-icon"),B=n("el-dropdown-menu"),I=n("el-dropdown"),S=n("el-space"),q=n("ProTable"),L=n("form-dialog");return z(),M("div",U,[l(q,{ref_key:"proTable",ref:p,title:u,columns:N,requestApi:H(W)},{tableHeader:s(()=>[l(a,{type:"primary",onClick:t[0]||(t[0]=i=>f("add"))},{default:s(()=>[d(m(o.$t("common.add")),1)]),_:1})]),operation:s(i=>[l(S,null,{default:s(()=>[l(a,{type:"warning",size:"small",onClick:_=>A(i.row)},{default:s(()=>[d(m(o.$t("common.reset")+o.$t("login.password")),1)]),_:2},1032,["onClick"]),l(I,{size:"default"},{dropdown:s(()=>[l(B,null,{default:s(()=>[v("div",{class:"dropdown-item",onClick:_=>f("update",{...i.row})},m(o.$t("common.edit")),9,Y),v("div",{class:"dropdown-item",onClick:_=>F(i.row)},m(o.$t("common.delete")),9,j)]),_:2},1024)]),default:s(()=>[l(a,{type:"success",size:"small"},{default:s(()=>[d(m(o.$t("common.more")),1),l(T,{class:"el-icon--right"},{default:s(()=>[l(g)]),_:1})]),_:1})]),_:2},1024)]),_:2},1024)]),_:1},8,["requestApi"]),l(L,{width:"70vw",columns:x,ref_key:"formDialogRef",ref:c},null,512)])}}});export{le as default};
