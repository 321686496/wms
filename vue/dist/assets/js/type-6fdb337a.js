import{u as v}from"./useHandleData-6ee70150.js";import{u as t,a as P}from"./index-16b2bfc2.js";import{o as S,C as w,q as r,t as z,M as O,v as s,w as l,a2 as m,L as u,x as c,K as U,E as V,av as W,aw as j}from"./vendor-7d8626b5.js";import{g as H,a as N,d as M,u as K,b as R}from"./type-78965f9f.js";const G={class:"table-box"},I=["onClick"],J=S({name:"base_sku_type"}),te=S({...J,setup(Q){const x=a=>new Promise((e,o)=>{const i=new FileReader;i.onload=n=>{const _=new Uint8Array(n.target.result),f=W(_,{type:"array"}),y=f.Sheets[f.SheetNames[0]],b=j.sheet_to_json(y,{header:1});e(b)},i.onerror=n=>{o(n)},i.readAsArrayBuffer(a)}),C=a=>new Promise(e=>{setTimeout(()=>{e(!0)},a)}),F=async a=>{try{const e=await x(a);let o=[];e.forEach(n=>{n.length===2&&o.push({id:n[0].trim(),classifyName:n[1].trim()})});let i=1;for(let n of o)V({type:"success",message:`${i}/${o.length}`,duration:200}),await C(200),await N(n),i+=1}catch{}return!1},g=t("base.product"),p=w(),k=w(),A=w([{type:"selection",fixed:"left",width:60},{prop:"id",label:t("type.id"),search:{el:"input"}},{prop:"classifyName",label:t("type.classifyName"),minWidth:120,search:{el:"input"}},{prop:"classifyNameFr",label:t("type.classifyNameFr"),minWidth:120,search:{el:"input"}},{prop:"createdAt",minWidth:150,label:t("common.createdAt")},{prop:"operation",label:t("common.operate"),width:180}]),B=[{field:"classifyName",type:"text",width:"200px",label:t("type.classifyName"),rules:[{required:!0,message:t("type.classifyName"),trigger:"blur"}]},{field:"classifyNameFr",type:"text",width:"200px",label:t("type.classifyNameFr"),rules:[{required:!0,message:t("type.classifyNameFr"),trigger:"blur"}]}],D=async a=>{await v(M,{id:a.id||0},t("common.delete")),p.value.getTableList()},T=(a,e)=>{a==="update"&&e&&(delete e.createdAt,delete e.updatedAt);let o={title:t(`common.${a}`)+g,rowData:{...e||{priority:0,enable:!0}},formType:a,api:a=="add"?N:K,getTableList:p.value.getTableList};k.value.acceptParams(o)},L=async a=>{try{const e=await v(R,{ids:a},t("common.delete"));p.value.getTableList(),p.value.clearSelection(),e.status===0&&P(e.data)}catch{}},$=(a,e)=>{switch(a){case"delete":L(e.map(o=>o.id||0));break}};return(a,e)=>{const o=r("el-button"),i=r("arrow-down"),n=r("el-icon"),_=r("el-dropdown-menu"),f=r("el-dropdown"),y=r("el-upload"),b=r("el-space"),q=r("ProTable"),E=r("FormDialog");return z(),O("div",G,[s(q,{ref_key:"proTable",ref:p,colSettingType:"base_sku",title:c(g),columns:A.value,requestApi:c(H)},{tableHeader:l(d=>[s(b,null,{default:l(()=>[s(o,{type:"primary",onClick:e[0]||(e[0]=h=>T("add"))},{default:l(()=>[m(u(c(t)("common.add")),1)]),_:1}),s(f,{disabled:!d.isSelected,size:"default"},{dropdown:l(()=>[s(_,null,{default:l(()=>[U("div",{class:"dropdown-item",onClick:h=>$("delete",d.selectedList)},u(c(t)("common.delete")),9,I)]),_:2},1024)]),default:l(()=>[s(o,{type:"primary",disabled:!d.isSelected},{default:l(()=>[m(u(c(t)("common.batch")),1),s(n,{class:"el-icon--right"},{default:l(()=>[s(i)]),_:1})]),_:2},1032,["disabled"])]),_:2},1032,["disabled"]),s(y,{action:"#","before-upload":F},{default:l(()=>[s(o,{type:"primary"},{default:l(()=>[m("Upload")]),_:1})]),_:1})]),_:2},1024)]),operation:l(d=>[s(o,{type:"primary",size:"small",onClick:h=>T("update",{...d.row})},{default:l(()=>[m(u(c(t)("common.edit")),1)]),_:2},1032,["onClick"]),s(o,{type:"danger",size:"small",onClick:h=>D(d.row)},{default:l(()=>[m(u(c(t)("common.delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["title","columns","requestApi"]),s(E,{width:"70vw","label-width":"140",columns:B,ref_key:"formDialogRef",ref:k},null,512)])}}});export{te as default};
