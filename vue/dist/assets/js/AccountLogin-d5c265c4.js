import{o as M,C as L,r as S,p as T,q as n,a7 as G,t as c,M as $,v as e,w as o,I as V,K as i,_ as H,x as r,u as x,a2 as y,L as w,a0 as I,P as J,am as O,an as Q}from"./vendor-7d8626b5.js";import{b as W,u as h,f as X,_ as Y}from"./index-16b2bfc2.js";import{u as Z}from"./useImgCaptcha-5fdd559e.js";import{u as ee}from"./useLoginSuccess-5ef2d3d2.js";import"./keepAlive-00d3a930.js";const oe=u=>(O("data-v-f7055a2d"),u=u(),Q(),u),te={class:"flx-justify-between",style:{gap:"10px",width:"100%"}},ae={style:{width:"100%"}},se=["src"],ne={class:"password-box flx-justify-between"},re=oe(()=>i("div",null,null,-1)),le={class:"login-btn"},ie=M({__name:"AccountLogin",emits:["forget","register","appoint"],setup(u,{emit:K}){const{sysConfig:p}=W(),{captchaUrl:F,getCaptcha:d,captchaLoading:U}=Z(),v=L(),P=(s,t,g)=>{new RegExp(p.system_regex_password).test(t)?g():g(new Error)},R=S({name:[{required:!0,message:h(["common.pleaseInput","login.mobile"]),trigger:"blur"}],password:[{required:!0,message:h(["common.pleaseInput","login.password"]),trigger:"blur"},{validator:P,message:h("error.PasswordFormatError"),trigger:"blur"}],imgCaptcha:[{required:!0,message:h(["common.pleaseInput","login.captcha"]),trigger:"blur"}]}),m=L(!1),a=S({name:"",password:"",imgCaptcha:""}),_=()=>{m.value||v.value&&v.value.validate(async s=>{if(!!s){m.value=!0;try{const t=await X({...a});await ee(t.data)}catch{d()}finally{m.value=!1}}})},q=()=>{a.name="",a.password="",a.imgCaptcha=""},z=()=>{K("register")},A=()=>{K("forget")};return T(()=>{d()}),(s,t)=>{const g=n("User"),f=n("el-icon"),C=n("el-input"),b=n("el-form-item"),B=n("lock"),E=n("Picture"),N=n("el-link"),D=n("el-form"),k=n("el-button"),j=G("loading");return c(),$(J,null,[e(D,{ref_key:"loginFormRef",ref:v,model:a,rules:R,size:"large"},{default:o(()=>[e(b,{prop:"name"},{default:o(()=>[e(C,{modelValue:a.name,"onUpdate:modelValue":t[0]||(t[0]=l=>a.name=l),clearable:"",placeholder:s.$t("login.mobile"),onKeyup:V(_,["enter"])},{prefix:o(()=>[e(f,{class:"el-input__icon"},{default:o(()=>[e(g)]),_:1})]),_:1},8,["modelValue","placeholder","onKeyup"])]),_:1}),e(b,{prop:"password"},{default:o(()=>[e(C,{type:"password",modelValue:a.password,"onUpdate:modelValue":t[1]||(t[1]=l=>a.password=l),placeholder:s.$t("login.password"),"show-password":"",clearable:"",autocomplete:"new-password",onKeyup:V(_,["enter"])},{prefix:o(()=>[e(f,{class:"el-input__icon"},{default:o(()=>[e(B)]),_:1})]),_:1},8,["modelValue","placeholder","onKeyup"])]),_:1}),e(b,{prop:"imgCaptcha"},{default:o(()=>[i("div",te,[i("div",ae,[e(C,{modelValue:a.imgCaptcha,"onUpdate:modelValue":t[2]||(t[2]=l=>a.imgCaptcha=l),clearable:"",placeholder:s.$t("login.captcha"),onKeyup:V(_,["enter"])},{prefix:o(()=>[e(f,{class:"el-input__icon"},{default:o(()=>[e(E)]),_:1})]),_:1},8,["modelValue","placeholder","onKeyup"])]),H((c(),$("div",null,[i("img",{src:r(F),alt:"",class:"captcha-img",onClick:t[3]||(t[3]=(...l)=>r(d)&&r(d)(...l))},null,8,se)])),[[j,r(U)]])])]),_:1}),i("div",ne,[re,r(p).system_open_register=="true"?(c(),x(N,{key:0,type:"primary",onClick:A},{default:o(()=>[y(w(s.$t("login.forgotPassword")),1)]),_:1})):I("",!0)])]),_:1},8,["model","rules"]),i("div",le,[r(p).system_open_register=="true"?(c(),x(k,{key:0,onClick:z,size:"large"},{default:o(()=>[y(w(s.$t("login.register")),1)]),_:1})):I("",!0),r(p).system_open_register=="false"&&r(p).system_open_appointment=="false"?(c(),x(k,{key:1,onClick:q,size:"large"},{default:o(()=>[y(w(s.$t("common.reset")),1)]),_:1})):I("",!0),e(k,{onClick:_,size:"large",type:"primary",loading:m.value},{default:o(()=>[y(w(s.$t("login.login")),1)]),_:1},8,["loading"])])],64)}}});const _e=Y(ie,[["__scopeId","data-v-f7055a2d"]]);export{_e as default};
