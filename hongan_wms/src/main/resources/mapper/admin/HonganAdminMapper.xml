<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hongan.template.admin.mapper.HonganAdminMapper">
    <select id="selectByIdXml" resultType="HonganAdmin">
        SELECT *
        FROM hongan_admin
        where id = #{id}
    </select>
    <select id="selectAdminList" resultType="HonganAdmin">
        SELECT a.*,r.name role_name,r.role_key,r.role_type
        FROM hongan_admin a
        LEFT JOIN hongan_role r ON a.role_id = r.id
        WHERE a.deleted = 0
        <if test="query.roleId !=null">
            and a.role_id = #{query.roleId}
        </if>
        <if test="query.deptId !=null and query.deptId > 0">
            and a.dept_id = #{query.deptId}
        </if>
        <if test="query.deptIds!=null and query.deptIds.size()>0">
            and a.dept_id in (
            <foreach collection="query.deptIds" item="item" separator=",">
                #{item}
            </foreach>
            )
        </if>
        <if test="query.roleKey !=null and !query.roleKey.isEmpty()">
            and a.role_key = #{query.roleKey}
        </if>
        <if test="query.status !=null">
            and a.status = #{query.status}
        </if>
        <if test="query.name !=null and !query.name.isEmpty()">
            and a.name like concat('%',#{query.name},'%')
        </if>
        <if test="query.phone !=null and !query.phone.isEmpty()">
            and a.phone like concat('%',#{query.phone},'%')
        </if>
        <if test="query.realName !=null and !query.realName.isEmpty()">
            and a.real_name like concat('%',#{query.realName},'%')
        </if>
        <if test="query.remark !=null and !query.remark.isEmpty()">
            and a.remark like concat('%',#{query.remark},'%')
        </if>
        limit #{pageNum},#{pageSize}
    </select>
    <select id="selectAdminListCount" resultType="Integer">
        select count(*) from (
        SELECT a.*,r.name role_name,r.role_key,r.role_type
        FROM hongan_admin a
        LEFT JOIN hongan_role r ON a.role_id = r.id
        WHERE a.deleted = 0
        <if test="query.roleId !=null">
            and a.role_id = #{query.roleId}
        </if>
        <if test="query.deptId !=null and query.deptId > 0">
            and a.dept_id = #{query.deptId}
        </if>
        <if test="query.deptIds!=null and query.deptIds.size()>0">
            and a.dept_id in (
            <foreach collection="query.deptIds" item="item" separator=",">
                #{item}
            </foreach>
            )
        </if>
        <if test="query.roleKey !=null and !query.roleKey.isEmpty()">
            and a.role_key = #{query.roleKey}
        </if>
        <if test="query.status !=null">
            and a.status = #{query.status}
        </if>
        <if test="query.name !=null and !query.name.isEmpty()">
            and a.name like concat('%',#{query.name},'%')
        </if>
        <if test="query.phone !=null and !query.phone.isEmpty()">
            and a.phone like concat('%',#{query.phone},'%')
        </if>
        <if test="query.realName !=null and !query.realName.isEmpty()">
            and a.real_name like concat('%',#{query.realName},'%')
        </if>
        <if test="query.remark !=null and !query.remark.isEmpty()">
            and a.remark like concat('%',#{query.remark},'%')
        </if>
        )c
    </select>
</mapper>
