import{o as S,C as u,q as r,t as g,u as k,w as s,K as N,v as t,a2 as b,L as y,x as m,M as B,P as M,O as W,_ as O,$ as j,E as z}from"./vendor-7d8626b5.js";import{u as n,o as G,_ as H}from"./index-16b2bfc2.js";import{q as J}from"./select-d4c05a16.js";import{a as Q}from"./serviceDict-09318a0d.js";const X={class:"dialog-footer"},Y=S({name:"DataScopeDialog"}),Z=S({...Y,props:{width:{default:"520px"},labelWidth:{default:"100px"}},setup(C,{expose:T}){const h=C,p=u(!1),e=u({title:"",formType:"add",rowData:{}}),w=u(),x=u({name:[{required:!0,message:n(["common.pleaseInput","system.role","common.name"]),trigger:"blur"}],roleKey:[{required:!0,message:n(["common.pleaseInput","system.role","common.character"]),trigger:"blur"}],dataScope:[{required:!0,message:n(["common.pleaseSelect","system.dataScope"]),trigger:"blur"}]}),i=u(!1),$=()=>{w.value.validate(async l=>{if(l){i.value=!0;let a=L();const d=e.value.handleData?e.value.handleData(e.value.rowData):{...e.value.rowData,deptIds:a};e.value.api(d).then(c=>{c.status===0&&(z.success({message:`${e.value.title}${n("common.success")}!`}),i.value=!1,e.value.getTableList&&e.value.getTableList(),p.value=!1)}).finally(()=>{i.value=!1})}})},f=u([]),v=u(),_=u({expand:!1,nodeAll:!1}),A=()=>{J().then(l=>{f.value=l.data,e.value.formType==="update"&&e.value.rowData.deptIds&&e.value.rowData.deptIds.length&&v.value.setCheckedKeys(e.value.rowData.deptIds)})},I=l=>{let a=f.value;for(let d=0;d<a.length;d++)v.value.store.nodesMap[a[d].value].expanded=l},K=l=>{const a=G(f.value);v.value.setCheckedNodes(l?a:[])},L=()=>v.value.getCheckedKeys();let R={roleType:"SUPER"};return T({acceptParams:l=>{A(),e.value={...l,rowData:l.formType==="add"?{...R}:l.rowData},p.value=!0}}),(l,a)=>{const d=r("el-input"),c=r("el-form-item"),U=r("el-option"),q=r("el-select"),D=r("el-checkbox"),F=r("el-tree"),P=r("el-form"),V=r("el-button"),E=r("el-dialog");return g(),k(E,{modelValue:p.value,"onUpdate:modelValue":a[6]||(a[6]=o=>p.value=o),title:e.value.title,width:h.width,"destroy-on-close":""},{footer:s(()=>[N("span",X,[t(V,{onClick:a[5]||(a[5]=o=>p.value=!1),disabled:i.value},{default:s(()=>[b(y(l.$t("common.cancel")),1)]),_:1},8,["disabled"]),t(V,{type:"primary",loading:i.value,onClick:$},{default:s(()=>[b(y(l.$t("common.submit")),1)]),_:1},8,["loading"])])]),default:s(()=>[t(P,{ref_key:"ruleFormRef",ref:w,"label-width":h.labelWidth,"label-suffix":" :",model:e.value.rowData,rules:x.value},{default:s(()=>[t(c,{label:m(n)(["system.role","common.name"]),prop:"name"},{default:s(()=>[t(d,{modelValue:e.value.rowData.name,"onUpdate:modelValue":a[0]||(a[0]=o=>e.value.rowData.name=o),placeholder:m(n)(["common.pleaseInput","system.role","common.name"]),clearable:"",disabled:""},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),t(c,{label:m(n)(["system.role","common.character"]),prop:"roleKey"},{default:s(()=>[t(d,{modelValue:e.value.rowData.roleKey,"onUpdate:modelValue":a[1]||(a[1]=o=>e.value.rowData.roleKey=o),placeholder:m(n)(["common.pleaseInput","system.role","common.character"]),clearable:"",disabled:""},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),t(c,{label:m(n)("system.dataScope"),prop:"dataScope"},{default:s(()=>[t(q,{modelValue:e.value.rowData.dataScope,"onUpdate:modelValue":a[2]||(a[2]=o=>e.value.rowData.dataScope=o),placeholder:m(n)(["common.pleaseSelect","system.dataScope"]),clearable:"",filterable:"",style:{width:"100%"}},{default:s(()=>[(g(!0),B(M,null,W(m(Q),o=>(g(),k(U,{key:o.value,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),O(t(c,{label:m(n)(["system.menu","system.permission"]),prop:"deptIds"},{default:s(()=>[t(D,{modelValue:_.value.expand,"onUpdate:modelValue":a[3]||(a[3]=o=>_.value.expand=o),onChange:I},{default:s(()=>[b(y(l.$t("common.expand")+"/"+l.$t("common.fold")),1)]),_:1},8,["modelValue"]),t(D,{modelValue:_.value.nodeAll,"onUpdate:modelValue":a[4]||(a[4]=o=>_.value.nodeAll=o),onChange:K},{default:s(()=>[b(y(l.$t("common.selectAll")+"/"+l.$t("common.deselectAll")),1)]),_:1},8,["modelValue"]),t(F,{ref_key:"menuTreeRef",ref:v,class:"tree-border",style:{width:"100%"},data:f.value,"show-checkbox":"","check-strictly":"","node-key":"value"},null,8,["data"])]),_:1},8,["label"]),[[j,e.value.rowData.dataScope==="CustomData"]])]),_:1},8,["label-width","model","rules"])]),_:1},8,["modelValue","title","width"])}}});const se=H(Z,[["__scopeId","data-v-63cb8b44"]]);export{se as default};
