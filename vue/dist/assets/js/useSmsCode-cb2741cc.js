import{G as v,d as S,e as g}from"./index-16b2bfc2.js";import{C as c,a as f,p,T as C,E as u}from"./vendor-7d8626b5.js";const I=()=>{const a=v(),{t:s}=S.global,o=c(!1);let e=c(0),t=0;const m=60,d=f(()=>e.value==0?s("login.sendSmsCode"):`${e.value}${s("login.second")}${s("login.repeat")}`),i=n=>{if(!o.value){if(n.type==="register"&&!n.imgCaptcha){u({message:`${s("common.pleaseInput")}${s("login.captcha")}`,type:"error"});return}o.value=!0,g(n).then(()=>{e.value=m,l(),u({message:s("common.sendSuccess"),type:"success"})}).finally(()=>{o.value=!1})}},l=()=>{t=setInterval(()=>{let n=e.value-1;n<=0?(clearInterval(t),t=0,e.value=0,a.setSmsSecond(0)):(e.value=n,a.setSmsSecond(e.value))},1e3)},r=()=>{clearInterval(t),t=0};return p(()=>{e.value=a.smsSecond||0,t&&r(),e.value>0&&l()}),C(()=>{r()}),{second:e,smsBtnStr:d,getSmsCode:i,smsLoading:o}},b=I;export{b as u};
